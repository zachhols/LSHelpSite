<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Retail|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>5 Set Up Gateway</title>
        <link rel="shortcut icon" href="/Content/Resources/Images/favicon.ico" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/LSNav.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" defer="defer">
        </script>
        <script src="../../../Resources/Javascripts/Scroll-Button.js" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-dropdown" style="display:none;" id="#centralSmallScreen"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../home.html" title="LS Central Help" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                    <div class="central-dropdown" style="display:none;" id="#centralTop"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="central-dropdown" style="display:none;"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <MadCap:conditionalText data-mc-conditions="Default.GoogleAnalytics">
                                        <script>/* <![CDATA[ */
				(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
				})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
			
				ga('create', 'UA-58791693-4', 'auto');
			
				var file = document.location.href; 
				file = file.substring(0, (file.indexOf("#") == -1) ? file.length : file.indexOf("#"));
				file = file.substring(0, (file.indexOf("?") == -1) ? file.length : file.indexOf("?"));
				file = file.substring(file.lastIndexOf("/") + 1, file.length);
 
				if (file === 'Search.htm') 
				{
					var newPath = document.location.pathname + document.location.search + document.location.hash;
					newPath = newPath.replace(/#/, '?');
					newPath = newPath.replace(/search\-/, 'q=');
					ga('set', 'page', newPath);
				
					function locationHashChanged()
					{
						newPath = document.location.pathname + document.location.search + document.location.hash;
						newPath = newPath.replace(/#/, '?');
						newPath = newPath.replace(/search\-/, 'q=');
						ga('set', 'page', newPath);
						ga('send', 'pageview');
					}
				
					if(window.HashChangeEvent)
					{
						window.onhashchange = locationHashChanged;
					}
				}
				ga('send', 'pageview');
			/* ]]> */</script>
                                    </MadCap:conditionalText>
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>&#160;</p>
                                    <div role="main" id="mc-main-content">
                                        <h1><a name="aanchor1719"></a>
                                            <MadCap:concept term="Retail" />5 Set Up Gateway and Schedules</h1>
                                        <h2>Verify creation of Azure Data Factory in Azure</h2>
                                        <ol>
                                            <li value="1">Open and log into <a href="https://portal.azure.com/" target="_blank">Azure portal.</a></li>
                                            <li value="2">Under Resources you will find the Azure Data Factory created with the deployment script.</li>
                                        </ol>
                                        <h2>Set up the Integration Runtime management gateway</h2>
                                        <p>It is now time for you to set up the Integration Runtime gateway that allows you to access the on-premises database(s) from Azure:</p>
                                        <ol>
                                            <li value="1">In Azure Portal, open the Azure Data Factory that was created by the Deployment script.</li>
                                            <li value="2">In the main window, open the <b>Author &amp; Monitor</b> link.</li>
                                            <li value="3">Open the <b>Manage</b> option, the toolbox icon on the left navigation menu.</li>
                                            <li value="4"> Open the <b>Integration runtimes</b> option from the left menu Connections section.</li>
                                            <li value="5">Open the <b>LSInsight-integrationRuntime</b> from the list.<p><img src="../../../Resources/Images/LS Insight Help/integrationruntime_700x209.png" style="width: 700;height: 209;" class="images" /></p></li>
                                            <li value="6">From the integration runtime you have two options to set up the Integration runtime (Gateway).<h4>Option 1: Express setup</h4><p>When you select this option, an <i>.exe</i> file starts to download, and once you run it the gateway is set up locally on your machine, without you having to do anything.</p><p><b>Note:</b> As mentioned in the <a href="../Prerequisites.htm">prerequisites,</a> this should be the default option, if you are logged into Azure and are running the script from the same domain server. </p><p><img src="../../../Resources/Images/LS Insight Help/gatwaylocal_400x276.png" style="width: 400;height: 276;" class="images" /></p><h4>Option 2: Manual setup</h4><p>When you select this option, you will download an <i>.exe </i>file to install integration runtime (Gateway) on a different machine. You can then copy the <i>.exe</i> file to any machine and use either key1 or key2 in the setup steps to register the gateway with this Azure data factory.</p></li>
                                            <li value="7">Once you have setup the Gateway, go back to Azure and click <b>Cancel</b> in the Integration runtime panel to close it.</li>
                                            <li value="8">  Then click <b>Refresh </b>in the <b>Integration runtimes</b> overview window to view the status for <b>LSInsight-integrationRuntime</b>. After you refresh, the status should be <i>Running</i>.</li>
                                        </ol>
                                        <h2>Run Query Base pipeline</h2>
                                        <p>Now that the connection to the <span class="GeneralLSCentral_Mini">LS&#160;Central</span> source database is ready you can start running the pipelines.</p>
                                        <p>First, you need to trigger a run of the pipeline that generates the queries to create and populate the staging tables:</p>
                                        <ol>
                                            <li value="1">In the Azure Data Factory, open the <b>Author</b> option, the pencil icon on the left navigation menu. Here you can see the <b>Pipelines</b> section, with all the available pipelines. There should be 15 pipelines.</li>
                                            <li value="2">Expand the <b>Pipelines</b> section and <b>5 - Pipeline Run Diagrams</b> folder.</li>
                                            <li value="3">Select the <b>Generate LS Insight Query Base</b> pipeline.</li>
                                            <li value="4">You then need to trigger this pipeline manually by selecting <b>Add Trigger</b> &gt; <b>Trigger now</b> from the top menu.<p><img src="../../../Resources/Images/LS Insight Help/TriggerGenerateQueryBase_700x363.png" class="images" style="width: 700;height: 363;" /></p></li>
                                            <li value="5">The <b>Pipeline run </b>window opens. Click <b>OK</b> to start the run.</li>
                                            <li value="6">This triggers the pipeline to start running and any notifications will be shown under the notification bell icon in the blue ribbon.</li>
                                            <li value="7">This run will take a few minutes and you must wait for it to finish before you continue.</li>
                                        </ol>
                                        <p>To monitor the run of the pipeline, see the <a href="../../Monitoring-Pipeline.htm">pipeline monitoring guideline</a></p>
                                        <h2>Activate the Scheduled Run pipeline trigger</h2>
                                        <p>Now you can finally activate the pipelines that move data from your <span class="GeneralLSCentral_Mini">LS&#160;Central</span> database to the Azure data warehouse:</p>
                                        <ol>
                                            <li value="1">In the Azure Data Factory (ADF), the <b>Manage</b> section, open <b>Triggers</b> from the left menu <b>Author</b> section. </li>
                                            <li value="2">When the ADF was created, the <b>Daily Scheduled Run</b> trigger was added and set to start at 3 AM the day after LS Insight is set up. To edit the trigger just open it by pressing the <b>Daily Scheduled Run</b> link and changing the start date and time and the timezone, if needed. You can also change the recurrence interval, but be aware that this will affect the cost of the service, shorter interval will increase the cost since more actions are run by the ADF. This is explained in more detail in the <a href="../Azure-Cost-Calculations.htm">cost calculations</a>.</li>
                                            <li value="3">When you have set the schedule start date and time, you can either activate it by selecting <b>Activated</b> - <b>Yes</b> and then pressing <b>OK</b>, or by just pressing <b>OK</b> to close the <b>Edit trigger</b> window, hover over the Daily Scheduled Run trigger in the list and clicking the <b>Play</b> icon.</li>
                                            <li value="4">Then select <b>Publish all</b> from the top menu to commit the changes to the server.<p><img src="../../../Resources/Images/LS Insight Help/ScheduleTrigger_700x300.png" class="images" style="width: 700;height: 300;" /></p></li>
                                        </ol>
                                        <p>Now the setup for LS Insight Azure Data Factory and Data Warehouse is done and will run as the trigger schedule settings specify.</p>
                                        <p>In case you do not want to wait for the scheduled run, you can now <a href="../../Manually-Run-Trigger.htm">manually run the pipeline trigger</a>, and <a href="../../Editing-Pipeline-Schedule.htm">edit the trigger schedule,</a> if needed.</p>
                                        <p><b>Tip:&#160;</b>If you wait for the schedule, it is a good idea to <a href="../../Monitoring-Pipeline.htm">monitor how the pipeline run went</a>.</p>
                                        <p>&#160;</p>
                                        <p><a href="4-Run-Deployment-Script.htm">&lt; Back</a><a style="float: right;" href="6-Connect-Power-BI-Reports.htm">Next &gt;</a>
                                        </p>
                                        <p>&#160;</p>
                                        <p>&#160;</p>
                                    </div>
                                    <div id="footer" class="ls-nav-footer">
                                        <hr width="100%" size="0" align="center" />
                                        <p>© <span class="VariablesCurrentYear">2021</span> LS Retail ehf. All rights reserved.  </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>