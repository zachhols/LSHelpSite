<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Retail|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|LS&#160;Central In-cloud and LS&#160;Insight in Azure">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>7 Set Up Schedules</title>
        <link rel="shortcut icon" href="/Content/Resources/Images/favicon.ico" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/LSNav.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" defer="defer">
        </script>
        <script src="../../../Resources/Javascripts/Scroll-Button.js" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-dropdown" style="display:none;" id="#centralSmallScreen"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../home.html" title="LS Central Help" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                    <div class="central-dropdown" style="display:none;" id="#centralTop"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="central-dropdown" style="display:none;"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <MadCap:conditionalText data-mc-conditions="Default.GoogleAnalytics">
                                        <script>/* <![CDATA[ */
				(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
				})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
			
				ga('create', 'UA-58791693-4', 'auto');
			
				var file = document.location.href; 
				file = file.substring(0, (file.indexOf("#") == -1) ? file.length : file.indexOf("#"));
				file = file.substring(0, (file.indexOf("?") == -1) ? file.length : file.indexOf("?"));
				file = file.substring(file.lastIndexOf("/") + 1, file.length);
 
				if (file === 'Search.htm') 
				{
					var newPath = document.location.pathname + document.location.search + document.location.hash;
					newPath = newPath.replace(/#/, '?');
					newPath = newPath.replace(/search\-/, 'q=');
					ga('set', 'page', newPath);
				
					function locationHashChanged()
					{
						newPath = document.location.pathname + document.location.search + document.location.hash;
						newPath = newPath.replace(/#/, '?');
						newPath = newPath.replace(/search\-/, 'q=');
						ga('set', 'page', newPath);
						ga('send', 'pageview');
					}
				
					if(window.HashChangeEvent)
					{
						window.onhashchange = locationHashChanged;
					}
				}
				ga('send', 'pageview');
			/* ]]> */</script>
                                    </MadCap:conditionalText>
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>&#160;</p>
                                    <div role="main" id="mc-main-content">
                                        <h1><a name="aanchor13578"></a>
                                            <MadCap:concept term="Retail" />7 Set Up Schedules</h1>
                                        <p>It is now time to finalize the replication and scheduling setup. You start in <span class="GeneralLSCentral_Mini">LS&#160;Central</span> on the Scheduler server and then you move on to Azure pipeline triggers.</p>
                                        <h2>Complete LS Insight Distribution Location Setup</h2>
                                        <ol>
                                            <li value="1">In <span class="GeneralLSCentral_Mini">LS&#160;Central</span>, on the Scheduler server, navigate to <b>Distribution Location List</b>.</li>
                                            <li value="2">Open the <b>LSINSIGHT</b> distribution location by clicking the code in the list.</li>
                                            <li value="3">In the <b>Replication</b> FastTab, add the following values:<ul><li value="1"><b>Company Name:</b> enter the company name from <span class="GeneralLSCentral_Mini">LS&#160;Central</span>, the one you used when setting up LS Insight.</li><li value="2"><b>User ID:</b> enter the admin user you created for LS Insight.</li><li value="3"><b>Password:</b> enter the password for the admin user you created for LS Insight.</li><li value="4"><b>Db Server Name:</b> the name of the LS Insight SQL&#160;server in Azure.</li><li value="5"><b>Db. Path &amp; Name:</b> the name of the LS Insight database.</li><li value="6"><b>Version: </b><i>15.00-SQL</i></li><li value="7"><b>Driver Type:</b> <i>SQL</i></li><li value="8"><b>Net Type: </b><i>tcp</i></li><li value="9"><b>Active for Replication:</b> turn on</li></ul></li>
                                            <li value="4">Click the <b>Test Connection</b> action.<ul><li value="1">A message box asks if you want to test the connection:&#160;click <b>Yes</b>.</li><li value="2">If the connection is successful, a message box is displayed with the time it took to test.</li><li value="3">If the connection is not successful, an error is displayed. </li></ul></li>
                                        </ol>
                                        <p> The connection should test successfully before you continue. If you get errors, most likely some of the replication parameters are incorrect. Check that your company and database information is correct. This should be the server information from the Deployment summary. The error message should also give an indication of what is wrong.</p>
                                        <h2>Open DD Configuration tool to view jobs running</h2>
                                        <ol>
                                            <li value="1">In your Windows Start menu type <i>Configuration</i>.</li>
                                            <li value="2">Open the Configuration tool as administrator.</li>
                                            <li value="3">In the <b>Debugging </b>tab you will find the <b>Job Monitor </b>button.</li>
                                        </ol>
                                        <h2>Run and schedule jobs</h2>
                                        <p>Now you are ready to run the jobs you  imported earlier. One of the replication jobs only needs to be run once, but the other jobs need to be scheduled to run every day or more often.</p>
                                        <h3>Run preload job</h3>
                                        <p>The LS Insight Action preload job (INS_ACTIONPRELOAD) needs to be run first and only once. This job will preload data for all tables that will then be updated by the LS Insight Action job. There might be some data that have been loaded or created in the database without actions being created, so this job will get everything.</p>
                                        <ol>
                                            <li value="1">Navigate to the <b>Scheduler Job List</b> in <span class="GeneralLSCentral_Mini">LS&#160;Central</span>.</li>
                                            <li value="2">Open <b>LS Insight Action preload job</b> by clicking the Job ID&#160;in the list.</li>
                                            <li value="3">Click the <b>Run Now</b> action. A confirmation message is displayed, click <b>Yes</b>.<ul><li value="1">If you get an error about the job not having a receiver, you need to navigate to <b>Related</b> - <b>Job</b> - <b>Receiver Groups</b> and add the<b> All</b> group as a receiver group. If you do not have a store group for all stores, you need to create it and then add it as a receiver group on the job.</li></ul></li>
                                            <li value="4">The job is started and a number of normal jobs run as displayed in a message box. For this job it should be 33 normal jobs.</li>
                                            <li value="5">You can review how the job run is progressing in the Data Director's <b>Job Monitor </b>window. Review the <a href="../../../LS-Retail/LS-Data-Director/Introduction.htm">Data Director</a> documentation for more information.</li>
                                        </ol>
                                        <h3>NAS configuration in <span class="GeneralLSCentral_Mini">LS&#160;Central</span> </h3>
                                        <p>After you have run this first job, it is time to enable the NAS service for the other jobs to start running on schedule.</p>
                                        <p>To enable the NAS&#160;follow these steps:</p>
                                        <ol>
                                            <li value="1">Navigate to the <b>Scheduler Setup</b> page in <span class="GeneralLSCentral_Mini">LS&#160;Central</span>.</li>
                                            <li value="2">Activate the <b>Enable NAS Scheduler</b> check box.</li>
                                            <li value="3">Close the<b> Scheduler Setup</b> page to make sure the change is saved.</li>
                                            <li value="4">Open Service Tier Administrator, and restart the <span class="GeneralLSCentral_Mini">LS&#160;Central</span> service.</li>
                                            <li value="5">When the service is running again, go back to the <span class="GeneralLSCentral_Mini">LS&#160;Central</span> web client.</li>
                                            <li value="6">Navigate to <b>Scheduler Setup</b>, and now the <b>Scheduler is Running</b> check box should be active as well.</li>
                                        </ol>
                                        <p>The NAS is now ready and will run the other three replication jobs on schedule.</p>
                                        <h3>Scheduling</h3>
                                        <p>It is a good idea to sync this replication schedule with the other two update schedules, that is the Azure pipeline schedule and the Power BI service refresh dataset schedule.</p>
                                        <p>Our recommendation is to run them in this order with approximately 2 hours between, and to start the first run after closing hours, if possible, so that the replication does not interfere with other usage of <span class="GeneralLSCentral_Mini">LS&#160;Central</span>. Here is a suggested schedule:</p>
                                        <ol>
                                            <li value="1">Replication jobs from <span class="GeneralLSCentral_Mini">LS&#160;Central</span> to LS Insight pre-staging tables (start at 11 p.m.).</li>
                                            <li value="2">Azure Data Factory pipelines (start at 1 a.m.).</li>
                                            <li value="3">Scheduled data set refresh in Power BI service (starts at 3 a.m.).</li>
                                        </ol>
                                        <p>When done this way, each part of the data update should be able to finish before the next one starts, and in the morning the Power BI reports have been updated with yesterdays Sales and Inventory data. </p>
                                        <p>We have added a default schedule to the three other jobs, between 11 p.m. and 1 a.m. You can review these schedules and the next run date and time from the <b>Scheduler</b> page in <span class="GeneralLSCentral_Mini">LS&#160;Central</span>.</p>
                                        <p>This can easily be changed, if needed, and the jobs will wait until the earlier one is finished before running, so setting the times closer together would also be fine.</p>
                                        <p>If you want to change the schedule, you can navigate to the <b>Scheduler</b> page and change the schedule settings from there and the NAS will pick them up. After NAS has started, you will not be able to change the job schedule from the job card.</p>
                                        <p>If you experience locking errors when trying to change a schedule from the <b>Scheduler </b>page, you can always disable the NAS while you change the jobs, but this will involve restarting the <span class="GeneralLSCentral_Mini">LS&#160;Central</span> service, which should not be an issue in our case since we are just using it for replication.</p>
                                        <p>Follow these steps to disable the NAS scheduler:</p>
                                        <ol>
                                            <li value="1">Navigate to the <b>Scheduler Setup</b> page in <span class="GeneralLSCentral_Mini">LS&#160;Central</span>.</li>
                                            <li value="2">Deactivate the <b>Enable NAS Scheduler</b> check box.</li>
                                            <li value="3">Close the <b>Scheduler Setup </b>page to make sure the change is saved.</li>
                                            <li value="4">Open Service Tier Administrator, and restart the <span class="GeneralLSCentral_Mini">LS&#160;Central</span> service.</li>
                                            <li value="5">When the service is running again, go back to the <span class="GeneralLSCentral_Mini">LS&#160;Central</span> web client.</li>
                                            <li value="6">Navigate to the <b>Scheduler Setup</b> page, and now the <b>Scheduler is Running</b> check box has been deactivated.</li>
                                        </ol>
                                        <p>The NAS has now been turned off and you can edit the jobs and schedules at will. Just remember to enable the NAS again once you are done to run the jobs on the new schedule.</p>
                                        <h2>Run Query Base pipeline</h2>
                                        <p>Now that the connection to the <span class="GeneralLSCentral_Mini">LS&#160;Central</span> source database is ready you can start running the pipelines.</p>
                                        <p>First, you need to trigger a run of the pipeline that generates the queries to create and populate the staging tables:</p>
                                        <ol>
                                            <li value="1">In the Azure Data Factory, open the <b>Author</b> option, the pencil icon on the left navigation menu. Here you can see the <b>Pipelines</b> section, with all the available pipelines. There should be 15 pipelines.</li>
                                            <li value="2">Expand the <b>Pipelines</b> section and <b>5 - Pipeline Run Diagrams</b> folder.</li>
                                            <li value="3">Select the <b>Generate LS Insight Query Base</b> pipeline.</li>
                                            <li value="4">You then need to trigger this pipeline manually by selecting <b>Add Trigger</b> &gt; <b>Trigger now</b> from the top menu.<p><img src="../../../Resources/Images/LS Insight Help/TriggerGenerateQueryBase_700x363.png" class="images" style="width: 700;height: 363;" /></p></li>
                                            <li value="5">The <b>Pipeline run </b>window opens. Click <b>OK</b> to start the run.</li>
                                            <li value="6">This triggers the pipeline to start running and any notifications will be shown under the notification bell icon in the blue ribbon.</li>
                                            <li value="7">This run will take a few minutes and you must wait for it to finish before you continue.</li>
                                        </ol>
                                        <p>To monitor the run of the pipeline, see the <a href="../../Monitoring-Pipeline.htm">pipeline monitoring guideline</a></p>
                                        <p><a name="ActivateScheduledRun"></a>
                                        </p>
                                        <h2>Activate the Scheduled Run pipeline trigger</h2>
                                        <p>Now you can finally activate the pipelines that move data from your <span class="GeneralLSCentral_Mini">LS&#160;Central</span> database to the Azure data warehouse:</p>
                                        <ol>
                                            <li value="1">In the Azure Data Factory (ADF), the <b>Manage</b> section, open <b>Triggers</b> from the left menu <b>Author</b> section. </li>
                                            <li value="2">When the ADF was created, the <b>Daily Scheduled Run</b> trigger was added and set to start at 3 AM the day after LS Insight is set up. To edit the trigger just open it by pressing the <b>Daily Scheduled Run</b> link and changing the start date and time and the timezone, if needed. You can also change the recurrence interval, but be aware that this will affect the cost of the service, shorter interval will increase the cost since more actions are run by the ADF. This is explained in more detail in the <a href="../Azure-Cost-Calculations.htm">cost calculations</a>.</li>
                                            <li value="3">When you have set the schedule start date and time, you can either activate it by selecting <b>Activated</b> - <b>Yes</b> and then pressing <b>OK</b>, or by just pressing <b>OK</b> to close the <b>Edit trigger</b> window, hover over the Daily Scheduled Run trigger in the list and clicking the <b>Play</b> icon.</li>
                                            <li value="4">Then select <b>Publish all</b> from the top menu to commit the changes to the server.<p><img src="../../../Resources/Images/LS Insight Help/ScheduleTrigger_700x300.png" class="images" style="width: 700;height: 300;" /></p></li>
                                        </ol>
                                        <p>Now the setup for LS Insight Azure Data Factory and Data Warehouse is done and will run as the trigger schedule settings specify.</p>
                                        <p>In case you do not want to wait for the scheduled run, you can now <a href="../../Manually-Run-Trigger.htm">manually run the pipeline trigger</a>, and <a href="../../Editing-Pipeline-Schedule.htm">edit the trigger schedule,</a> if needed.</p>
                                        <p><b>Tip:&#160;</b>If you wait for the schedule, it is a good idea to <a href="../../Monitoring-Pipeline.htm">monitor how the pipeline run went</a>.</p>
                                        <p>As mentioned before, it is good that the pipelines run after the replication and before the Power BI&#160;report, scheduled refresh.</p>
                                        <p>&#160;</p>
                                        <p><a href="6-Run-Deployment-Script.htm">&lt; Back</a><a style="float: right;" href="8-Connect-Power-BI-Reports.htm">Next &gt;</a>
                                        </p>
                                        <p>&#160;</p>
                                        <p>&#160;</p>
                                    </div>
                                    <div id="footer" class="ls-nav-footer">
                                        <hr width="100%" size="0" align="center" />
                                        <p>© <span class="VariablesCurrentYear">2021</span> LS Retail ehf. All rights reserved.  </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>