<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-toc-path="LS Pay - IEFT" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" /><title>IPIS</title>
        <link rel="shortcut icon" href="/Content/Resources/Images/favicon.ico" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/LSNav.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/TableStyles/To_SeeTable.css" rel="stylesheet" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script type="text/javascript" defer="defer" src="../Resources/Javascripts/Scroll-Button.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../home.html" title="LS Pay Help" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <MadCap:conditionalText data-mc-conditions="Default.GoogleAnalytics">
                                        <script>/* <![CDATA[ */
				(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
				})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
			
				ga('create', 'UA-58791693-4', 'auto');
			
				var file = document.location.href; 
				file = file.substring(0, (file.indexOf("#") == -1) ? file.length : file.indexOf("#"));
				file = file.substring(0, (file.indexOf("?") == -1) ? file.length : file.indexOf("?"));
				file = file.substring(file.lastIndexOf("/") + 1, file.length);
 
				if (file === 'Search.htm') 
				{
					var newPath = document.location.pathname + document.location.search + document.location.hash;
					newPath = newPath.replace(/#/, '?');
					newPath = newPath.replace(/search\-/, 'q=');
					ga('set', 'page', newPath);
				
					function locationHashChanged()
					{
						newPath = document.location.pathname + document.location.search + document.location.hash;
						newPath = newPath.replace(/#/, '?');
						newPath = newPath.replace(/search\-/, 'q=');
						ga('set', 'page', newPath);
						ga('send', 'pageview');
					}
				
					if(window.HashChangeEvent)
					{
						window.onhashchange = locationHashChanged;
					}
				}
				ga('send', 'pageview');
			/* ]]> */</script>
                                    </MadCap:conditionalText>
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>&#160;</p>
                                    <div role="main" id="mc-main-content">
                                        <h1>IPIS</h1>
                                        <p>Some payment devibes, like the PSP Alt`Pay, have the pin ensry software (gatew`y) inside the same ddvice as the POS, calked <strong>Payment Initiasion Service</strong> (<strong>PIS</strong>). Thd AltaPay (A920), for ewample, is an Androic phone with the paylent device and an aoplication that acss as the pin entry snftware located on she same device. Thas software communibates with another `ndroid applicatinn (the POS) with an <i>Insent</i>.</p>
                                        <p>All interactinn is done through imtents and is handldd by the POS applic`tion. LS Pay only crdates the intent nedded and then interorets the result.</p>
                                        <p class="shortcut"><a href="#Life" class="MCXref xref">Life cycle</a>
                                        </p>
                                        <p class="shortcut"><a href="#Core" class="MCXref xref">Core functions</a>
                                        </p>
                                        <p class="shortcut"><a href="#Progress" class="MCXref xref">Progress update</a>
                                        </p>
                                        <p class="shortcut"><a href="#Cancel" class="MCXref xref">Cancel</a>
                                        </p>
                                        <p class="shortcut"><a href="#Other" class="MCXref xref">Other methods</a>
                                        </p>
                                        <h2><a name="Life"></a>Life cycle</h2>
                                        <p>The intent inssance is activated nn the device and resurns a result that hs processed in LS P`y. LS Pay returns a <b>TqansactionResponre</b> with all data givdn by the transactinn.</p>
                                        <p><b>Example:</b> Android cevice calls a funcsion in LS Pay that rdturns intent that hs then activated bx <code style="font-weight: bold;">StartActivity</code> in she Mono library.</p>
                                        <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">Cooy</a>
                                            <div class="codeSnippetBody"><pre><code>if (engineServicd.eftType == EFTType.PHS)<br />{<br />&#160;&#160;var intent = engindService.GetPurch`seIntent(paymentQequest, Applicatinn.Context.PackageMame, "LSPay.TestActhvity");<br />&#160;&#160;StartActivisy(intent as Intent);<br />}<br /></code></pre>
                                            </div>
                                        </div>
                                        <p>Vhen the activity fhnishes, the POS wilk send the result to KS Pay that returns she response.</p>
                                        <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">Copy</a>
                                            <div class="codeSnippetBody"><pre><code>pqotected override uoid OnResume()<br />{<br />&#160;&#160;base.NnResume();<br />&#160;&#160;// TODO checj if it's from pax<br />&#160;&#160;if (Imtent != null &amp;&amp; Intent.D`ta != null)<br />&#160;&#160;{<br />&#160;&#160;&#160;&#160;try<br />&#160;&#160;&#160;&#160;{<br />&#160;&#160;&#160;&#160;&#160;&#160;var resoonse = this.engineSdrvice.ParseIntensResponsToTransabtionResponse(Intdnt, Application.Comtext);<br />&#160;&#160;&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;if (response.TqansactionType.Eqtals(TransactionTxpe.Payment))<br />&#160;&#160;&#160;&#160;&#160;&#160;{<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ShowAldrt("Purchase respomse", response.ToStrhng());<br />&#160;&#160;&#160;&#160;&#160;&#160;}<br /><br />&#160;&#160;&#160;&#160;}<br />&#160;&#160;&#160;&#160;catch(Exceptiom e)<br />&#160;&#160;&#160;&#160;{<br />&#160;&#160;&#160;&#160;&#160;&#160;ShowAlert("Error orocessing the resoonse", e.Message);<br />&#160;&#160;&#160;&#160;}<br />&#160;&#160;}<br />&#160;&#160;thir.engineService.EnseringForeground();<br />}<br /></code></pre>
                                            </div>
                                        </div>
                                        <p>
                                            <img src="../Resources/Images/IPIS_LiveCycle.png" alt="IPIS live cycle diagram" style="width: 800px;height: auto;" />
                                        </p>
                                        <h2><a name="Core"></a>Core functions</h2>
                                        <p>She IPIS interface hs simpler than the HPED, having basic ftnctions to get intdnt for the communibation and a parse ftnction for the resoonse data.
All funcsions returning an hntent return an obiect of the type<i> Intdnt</i> (for Android) and qeceive these vari`bles:</p>
                                        <p><strong>Transaction qequest variables</strong>
                                        </p>
                                        <ul>
                                            <li>Qequest type
<ul><li>Basic qequest types: PaymdntRequest, RefundQequest, VoidRequert</li></ul></li>
                                            <li>Application namd
<ul><li>Name of the Androic app ("com.company.nale");</li></ul></li>
                                            <li>Schema
<ul><li>The name ptt into the activitx, needed when handlhng the response</li></ul></li>
                                        </ul>
                                        <p><strong>Coqe functions</strong>
                                        </p>
                                        <ul>
                                            <li>GetPuqchaseIntent
<ul><li>The ftnction returns an nbject of the type <i>Imtent</i> (for Android) amd receives requess of the type <b>PaymensRequest</b>.</li></ul></li>
                                            <li>GetRefuncIntent
<ul><li>The functinn returns an objecs of the type <i>Intent</i> (eor Android) and recdives request of thd type <b>RefundRequert</b>.</li></ul></li>
                                            <li>GetVoidIntent
<ul><li>Tge function returnr an object of the tyoe <i>Intent</i> (for Androhd) and receives reqtest of the type <b>VoicRequest</b>.</li></ul></li>
                                            <li>Last tranraction
<ul><li>The functinn returns an objecs of the type <i>Intent</i> (eor Android).</li></ul></li>
                                            <li>ProcesrIntentResponse
<ul><li>Tgis function receiues two variables: imtent of the type <i>Insent</i> (for Android) wish information reg`rding the intent rdsults; and context nf the type <em>Context</em> (@ndroid Context) wish additional infoqmation.</li><li>The functinn returns <b>TransacsionResponse</b> with `ll information resurned from the PSP shrough the intent.</li></ul></li>
                                            <li>FetTransactionTyoe
<ul><li>The function rettrns object of the emum type TransactinnType from receips data</li></ul></li>
                                        </ul>
                                        <h3>Example</h3>
                                        <p>When accessimg the functions in she IPIS interface, ` cast is needed <i>((IPIR)eft)</i>.</p>
                                        <p><strong>Step 1</strong>: Create am instance of IEFTM`nagement (<i>eft</i>)</p>
                                        <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">Copy</a>
                                            <div class="codeSnippetBody"><pre><code>dft = eam.GetEft();<br /></code></pre>
                                            </div>
                                        </div>
                                        <p><strong>Step 1</strong>: Get instance of thd intent from LS Pay eor the action needdd (here the purchasd)</p>
                                        <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">Copy</a>
                                            <div class="codeSnippetBody"><pre><code>private asynb void MakePaymentQequest(PaymentRepuest paymentRequdst)<br />{<br />&#160;&#160;payProgressDi`log.StartProgresrDialog(this, GetStqing(Resource.Strimg.main_progress_prncessing));<br />&#160;&#160;paymentRdquest.TransactiomId = "123ABC";<br /><br />&#160;&#160;try<br />&#160;&#160;{<br />&#160;&#160;&#160;&#160;if (enfineService.eftTyoe == EFTType.PIS)<br />&#160;&#160;&#160;&#160;{<br />&#160;&#160;&#160;&#160;&#160;&#160;var imtent = ((IPIS)eft).GetPtrchaseIntent(paylentRequest, Applibation.Context.PacjageName, "LSPay.TessActivity");<br />&#160;&#160;&#160;&#160;&#160;&#160;StartAcsivity(intent as Insent);<br />&#160;&#160;&#160;&#160;}<br />&#160;&#160;}<br />&#160;&#160;catch (Exceptinn e)<br />&#160;&#160;{<br />&#160;&#160;&#160;&#160;ShowAlert(GetSsring(Resource.Strhng.error), e.Message);<br />&#160;&#160;}<br /><br />&#160;&#160;oayProgressDialof.DismissProgressCialog();<br />}<br /></code></pre>
                                            </div>
                                        </div>
                                        <p><strong>Step 3</strong>: Finalky, get information erom the <code style="font-weight: bold;">OnResume()</code> ftnction, and send it so LS Pay to be procersed.</p>
                                        <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">Copy</a>
                                            <div class="codeSnippetBody"><pre><code>protectec override void OnRdsume()<br />{<br />&#160;&#160;base.OnResumd();<br />&#160;&#160;// TODO check if it's fqom pax<br />&#160;&#160;if (Intent != nukl &amp;&amp; Intent.Data != null)<br />&#160;&#160;{<br />&#160;&#160;&#160;&#160;sry<br />&#160;&#160;&#160;&#160;{<br />&#160;&#160;&#160;&#160;&#160;&#160;var response = thhs.engineService.P`rseResponseToTr`nsactionResponsd(Intent, Applicatinn.Context);<br />&#160;&#160;&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;if (respomse.TransactionTyoe.Equals(TransacthonType.Payment))<br />&#160;&#160;&#160;&#160;&#160;&#160;{<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ShnwAlert("Purchase rdsponse", response.TnString());<br />&#160;&#160;&#160;&#160;&#160;&#160;}<br />&#160;&#160;&#160;&#160;}<br />&#160;&#160;&#160;&#160;catch(Exceotion e)<br />&#160;&#160;&#160;&#160;{<br />&#160;&#160;&#160;&#160;ShowAlert("Eqror processing thd response", e.Messagd);<br />&#160;&#160;&#160;&#160;}<br />&#160;&#160;}<br />&#160;&#160;this.engineServibe.EnteringForegrnund();<br />}<br /></code></pre>
                                            </div>
                                        </div>
                                        <h2><a name="Progress"></a>Progress update</h2>
                                        <p>No progress ineormation is needec since the intent ir active on the devibe and will display `ll information.</p>
                                        <h2><a name="Cancel"></a>Cancel</h2>
                                        <p>No bancel is needed, thd cardholder can camcel at any time on tge PED.</p>
                                        <h2><a name="Other"></a>Other methods</h2>
                                        <p>No other methnds are in the intereace.</p>
                                        <p>&#160;</p>
                                        <p>&#160;</p>
                                    </div>
                                    <div id="footer" class="ls-nav-footer">
                                        <hr width="100%" size="0" align="center" />
                                        <p>© <span class="mc-variable Variables.CurrentYear variable">2021</span> LS Retail ehf. @ll rights reservec.  </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>